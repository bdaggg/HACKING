Hello everyone, in this project I will make a detailed solution of the Sql injection part of Damn Vulnerable Web Application, a vulnerable web application.

<img width="510" alt="1" src="https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/2ce47a6e-b9ee-421c-8cfa-57ecd64b0082">

First I will exploit the vulnerability in a manual way and then I will do the exploitation process using the sqlmap tool. let's start if you are ready.

![2](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/4bc47399-a99e-4a9b-b196-e0001a42df12)

step 1: when we write user id = 1, it brings us the information of the user with id number 1. from here we understand that a query is running in the background that brings information from the database. so can we exploit the database with the help of this query. we won't know without trying.

![EKSİK1](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/99e9a531-2673-4398-b651-bdaa45dc0773)

step 2: when we write user id = 1' we see a sql syntax error. so we have broken the query running in the background. so what did we actually do. let me explain this on an example. In fact, the system assigns the value it receives from us to a variable called id and runs a query like this in the background: SELECT first_name, last_name FROM users WHERE user_id = '$id' actually the 1' expression we wrote is put where the $id expression is. because we put an extra quotation mark ('), the syntax of the query is broken and an error is thrown. it seems that the expressions we write are placed into the background query without any control. now let's make preparations to ask our own query in the next step.

![3](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/7d7a1cc8-7416-4e52-ba18-9778f5c50870)

step 3: in this step, when we type user id = 1' or '2'='2'# or user id = 1' or '2'='2, we manage to get the information of all users in the system. after this step, we are now sure that there is an sql injection vulnerability in the system. in the next steps, we will try to access more than the information we see on the screen.

![4](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/765ed3d1-dab7-4eb6-b674-be0ac9e57f00)

step 4: in this step we enter the statement user id = 1' union select 1# with this statement we are trying to find out how many tables are used in the background. but we get the error 'The used SELECT statements have a different number of columns' and we understand that more than 1 table is actually used. let's increase the number of tables.

![Ekran Görüntüsü (348)](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/2e665aeb-a8d0-42c0-8cc7-463eff08b2dc)

step 5: in this step we enter the expression user id = 1' union select 1,2# and when we enter this expression, our query works. so what did we do, let's talk about this.

First, let's remember our estimated query again: SELECT first_name, last_name FROM users WHERE user_id = '$id' user id = 1' union selecet 1# when we type our new query: SELECT first_name, last_name FROM users WHERE user_id = '1' union selecet 1#' Before explaining this expression, let me explain what the union expression does. union is an operator that joins queries. But for it to work, the column numbers in both queries must be the same, otherwise it will not work. now let's go back to our query. SELECT first_name, last_name FROM users WHERE user_id = '1' union selecet 1#' The first part of this combined query brings user information with user_id value 1, the second part does not do any function, but we said that the number of tables in both queries must be equal for the first query to work. the selecet 1 part in our second query was written only to find out if 1 table was used or not (1 is symbolic and does not represent the number of tables as a value). because if 1 table was used then no error is received and the first query works. but if we remember we got the error 'The used SELECT statements have a different number of columns'. so we wrote the statement 'user id = 1' union select 1,2#. now let's examine our new query in detail; SELECT first_name, last_name FROM users WHERE user_id = '1' union select 1,2#' In the first part of this query, we wanted it to return the user with id value 1, and in the second part, we tried to find out if two tables were used. With the # statement, we prevented us from getting a syntax error by taking the extra quote ('') from the background query into the comment line. When I ran this query, we did not get any error and we got the information of the user whose id value was 1. In this way, we understood that two tables were used in our query. so what will this do? let's look at the answer to this question in the next step.

![Ekran Görüntüsü (349)](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/53a04928-9cf2-4e66-a83e-03dfd1d0c117)

step 6: user id = 1 ' union select table_name,2 from information_schema.tables# with this statement we get the names of the tables used in the database. information_schema is a topic worth researching and it is too deep for me to explain here. My advice is to spend time on information_schema and learn about this topic by doing a detailed research. With information_schema, we want it to give us all the table names instead of table number 1 and this is how we get the table names.

![adım7](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/65168b34-9374-4339-b640-dbb7766696e7)

step 7: user id = 1' union select column_name,2 from information_schema.columns where table_name='users'# in this step, we randomly select a table from the tables we just found and try to find its columns. we managed to print the columns of the users table on the screen thanks to the query we wrote. let's take a look at the query we wrote this time; in our query, this time we told the system we are targeting columns from information_schema. columns, we told the system that we are targeting the columns. with the expression where table_name='users'# we told which table's column we are targeting. with the expression select column_name, 2 we told it to print us the column names instead of table 1 and we completed our query and in this way we managed to get all the columns in the users table.

![adım8](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/a1399614-b586-4d33-bd40-33cf9163e719)

step 8: user id = 1' union select first_name,last_name from users# with this query we are actually at the end of the manual experiment because we will be able to pull the data in the columns we want in the users table. i pulled the data in the first_name and last_name columns, but you can use the same logic to get the data in all columns of all tables. next we will use SQLMAP, one of the tools in kali linux, to automatically pull data faster. but understanding the manual part very well will actually help you understand how SQLMAP works. let's try to do the same with SQLMAP.

![sqlmap](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/da70e2f8-b1e3-438f-a77b-41a6492a901e)

The sqlmap tool is, in my opinion, the most powerful tool ever developed in sql injection attacks. you will understand better why I think so when we move on to its use in a moment. But I need to make an important point before using the sqlmap tool. if you have noticed in the web applications that you open an account and enter, when you switch between pages, the application does not ask you for your account information again every time because a special cookie is provided to you in the background. if this cookie information is stolen, someone can log in to your account using only your cookie information even without knowing your username and password. So why did I explain this? When logging in to the DVWA application, which is the vulnerable web application we use, it asks username and password from us, which means that a special cookie is defined for us. we need to give the cookie information when attacking with the sqlmap tool. if we do not give it, we will not be able to log in to the system and we will be stuck on the login page. if this is understood, let's start using the sqlmap tool.

![sqlmap](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/01b7a28d-9569-475d-ad60-15f75301ed8c)

step 1: in the terminal; sqlmap -u 'http://192.168.65.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#' -p id --cookie 'security=low; security_level=0; PHPSESSID=9cnfgb79prf6hcgkssn750i300; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada' -dbs. let's examine this expression in detail. First, by typing sqlmap, we told the terminal that the tool we will use is sqlmap. then we gave the address we will attack with the expression -u 'http://192.168.65.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#'. With the expression -p id, we specified the variable we will attack in the url. With --cookie 'security=low; security_level=0; PHPSESSID=9cnfgb79prf6hcgkssn750i300; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada' we wrote our cookie information, you can see how we get this cookie information from the picture be

![sqlmap2](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/cda3f975-8fec-4523-a7ae-ba9af06b8ee6)

Finally, we asked -dbs to find the databases used in the system for us.

![sqlmap3](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/410dd263-814c-4369-9310-b9fb670561f1)

When we ran our command, it showed us that there are two databases used in the system as shown in the picture above. these are: dvwa and information_schema databases. I have already recommended you to search for information_schema databases. now let's try to find the tables used in the dvwa database.

![sqlmap4](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/59a088fd-4675-447f-899c-2ac0d4574c45)

step 2: in terminal; sqlmap -u 'http://192.168.65.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#' -p id --cookie 'security=low; security_level=0; PHPSESSID=9cnfgb79prf6hcgkssn750i300; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada' -D dvwa --tables and run it.

![sqlmap5](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/aecab604-d9bf-44c4-8ff3-dcc0581c4e6c)

When we run our command, we see that there are two tables in the dvwa database as seen above. these are guestbook and users tables. now let's find the data in these tables.

![sqlmap6](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/45cb7a04-2fdf-4a88-89e6-712993c461f7)

step 3: this time in the terminal: sqlmap -u 'http://192.168.65.129/dvwa/vulnerabilities/sqli/?id=1&Submit=Submit#' -p id --cookie 'security=low; security_level=0; PHPSESSID=9cnfgb79prf6hcgkssn750i300; acopendivids=swingset,jotto,phpbb2,redmine; acgroupswithpersist=nada' -D dvwa -T users --dump In this way, we bring all columns in the user table together with the data in them

![sqlmap7](https://github.com/bdaggg/DVWA-Vulnerability-SQL-Injection/assets/110742864/8706d7ca-9d66-4204-84dc-30d0649b51a3)

As seen in the picture above, we managed to get all the columns in the users table and the data in the columns. using the same logic, it is possible to pull the data of all tables in all databases. we received the passwords in hashed form. there are many ways to decrypt hashed passwords. it can be found with a little research.
